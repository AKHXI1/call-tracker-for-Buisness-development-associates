<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Call Tracker</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    
    
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #b7cdf9, #006c86);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: #222;
    }
    .container {
      width: 100%;
      max-width: 1000px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;
      transition: 0.2s;
    }
    .card:hover { transform: scale(1.05); }
    h2 { margin-bottom: 15px; font-size: 20px; }
    .count {
      font-size: 28px;
      margin: 15px 0;
      color: #333;
      font-weight: bold;
    }
    button {
      margin: 5px;
      background: #4f46e5;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #4338ca; }
    .minus { background: #dc2626; }
    .minus:hover { background: #b91c1c; }
    .reset {
      background: #f59e0b;
      margin-top: 20px;
      font-size: 18px;
      padding: 12px 20px;
    }
    .reset:hover { background: #d97706; }
    .export {
      background: #16a34a;
      margin-top: 10px;
      font-size: 18px;
      padding: 12px 20px;
    }
    .export:hover { background: #15803d; }

    /* Category colors */
    .fresh { border-top: 4px solid #2563eb; }
    .positive { border-top: 4px solid #16a34a; }
    .neutral { border-top: 4px solid #facc15; }
    .not-interested { border-top: 4px solid #dc2626; }
    .followup { border-top: 4px solid #0891b2; }
    .followup-positive { border-top: 4px solid #22c55e; }
    .followup-not { border-top: 4px solid #b91c1c; }

    /* Summary Table */
    .summary {
      margin-top: 40px;
      width: 100%;
      max-width: 1000px;
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      font-size: 14px;
    }
    th {
      background: #4f46e5;
      color: white;
    }
    tr:nth-child(even) { background: #f9f9f9; }
    .dialog-box {
    position: fixed;
    top: 80px;
    right: 20px;
    width: 280px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    padding: 15px;
    font-family: monospace;
    font-size: 14px;
    white-space: pre-line;
    z-index: 1000;
  }
  .dialog-box h3 {
    margin: 0 0 10px;
    font-size: 16px;
    color: #4f46e5;
    text-align: center;
  }
  .copy-btn {
    background: #16a34a;
    margin-top: 10px;
    width: 100%;
    padding: 8px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    color: #fff;
    font-size: 14px;
  }
  .copy-btn:hover {
    background: #15803d;
  }
  </style>
</head>
<body>
  <h1>ðŸ“ž Call Tracker</h1>
  <button class="reset" onclick="resetAll()">ðŸ”„ Reset All</button>
  <button class="export" onclick="exportToExcel()">ðŸ“¤ Export to Excel</button>

  <div class="container">
    <div class="card fresh">
      <h2>Fresh Calls</h2>
      <div class="count" id="fresh">0</div>
      <button onclick="increment('fresh')">+ Add</button>
      <button class="minus" onclick="decrement('fresh')">- Minus</button>
    </div>

    <div class="card positive">
      <h2>Positives</h2>
      <div class="count" id="positive">0</div>
      <button onclick="increment('positive')">+ Add</button>
      <button class="minus" onclick="decrement('positive')">- Minus</button>
    </div>

    <div class="card neutral">
      <h2>Neutrals</h2>
      <div class="count" id="neutral">0</div>
      <button onclick="increment('neutral')">+ Add</button>
      <button class="minus" onclick="decrement('neutral')">- Minus</button>
    </div>

    <div class="card not-interested">
      <h2>Not Interested</h2>
      <div class="count" id="not">0</div>
      <button onclick="increment('not')">+ Add</button>
      <button class="minus" onclick="decrement('not')">- Minus</button>
    </div>

    <div class="card followup">
      <h2>Follow-ups</h2>
      <div class="count" id="followup">0</div>
      <button onclick="increment('followup')">+ Add</button>
      <button class="minus" onclick="decrement('followup')">- Minus</button>
    </div>

    <div class="card followup-positive">
      <h2>Follow-up Positives</h2>
      <div class="count" id="followupPositive">0</div>
      <button onclick="increment('followupPositive')">+ Add</button>
      <button class="minus" onclick="decrement('followupPositive')">- Minus</button>
    </div>

    <div class="card followup-not">
      <h2>Follow-up Not Interested</h2>
      <div class="count" id="followupNot">0</div>
      <button onclick="increment('followupNot')">+ Add</button>
      <button class="minus" onclick="decrement('followupNot')">- Minus</button>
    </div>
  </div>
    <div class="dialog-box">
      <h3>ðŸ“‹ Current Update</h3>
      <div id="dialogContent"></div>
        <button class="copy-btn" onclick="copyDialog()">Copy</button>
  </div>

  <!-- Summary Section -->
  <div class="summary">
    <h2>ðŸ“Š Last 7 Days Summary</h2>
    <table id="summaryTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Fresh Calls</th>
          <th>Positives</th>
          <th>Neutrals</th>
          <th>Not Interested</th>
          <th>Follow-ups</th>
          <th>Follow-up Positives</th>
          <th>Follow-up Not Interested</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const categories = ["fresh","positive","neutral","not","followup","followupPositive","followupNot"];
    const labels = {
      fresh: "Fresh Calls",
      positive: "Positives",
      neutral: "Neutrals",
      not: "Not Interested",
      followup: "Follow-ups",
      followupPositive: "Follow-up Positives",
      followupNot: "Follow-up Not Interested"
    };

    // Load data on page load
    window.onload = () => {
      checkNewDay(); // auto-save for new day
      categories.forEach(cat => {
        let saved = localStorage.getItem(cat) || 0;
        document.getElementById(cat).innerText = saved;
      });
      loadSummary();
      scheduleMidnightSave();
    };

    function increment(category) {
      let count = parseInt(localStorage.getItem(category) || 0);
      count++;
      localStorage.setItem(category, count);
      document.getElementById(category).innerText = count;
      saveSummary();
    }

    function decrement(category) {
      let count = parseInt(localStorage.getItem(category) || 0);
      if (count > 0) count--;
      localStorage.setItem(category, count);
      document.getElementById(category).innerText = count;
      saveSummary();
    }

    function resetAll() {
      if (confirm("Are you sure you want to reset all counts?")) {
        categories.forEach(cat => {
          localStorage.setItem(cat, 0);
          document.getElementById(cat).innerText = 0;
        });
        saveSummary();
      }
    }

    function saveSummary() {
      const today = new Date().toLocaleDateString();
      let summary = JSON.parse(localStorage.getItem("summary") || "[]");

      let existing = summary.find(row => row.date === today);
      if (!existing) {
        existing = { date: today };
        categories.forEach(c => existing[c] = 0);
        summary.push(existing);
      }

      categories.forEach(c => {
        existing[c] = parseInt(localStorage.getItem(c) || 0);
      });

      // Keep only last 7 days
      if (summary.length > 7) {
        summary = summary.slice(summary.length - 7);
      }

      localStorage.setItem("summary", JSON.stringify(summary));
      localStorage.setItem("lastSavedDate", today);
      loadSummary();
    }

    function loadSummary() {
      let summary = JSON.parse(localStorage.getItem("summary") || "[]");
      let tbody = document.getElementById("summaryTable").querySelector("tbody");
      tbody.innerHTML = "";
      summary.forEach(row => {
        let tr = "<tr><td>"+row.date+"</td>";
        categories.forEach(c => {
          tr += "<td>"+(row[c] || 0)+"</td>";
        });
        tr += "</tr>";
        tbody.innerHTML += tr;
      });
    }

    function checkNewDay() {
      const today = new Date().toLocaleDateString();
      const lastSavedDate = localStorage.getItem("lastSavedDate");

      if (lastSavedDate !== today) {
        // Save yesterday's summary before reset
        saveSummary();

        // Reset counters for new day
        categories.forEach(cat => {
          localStorage.setItem(cat, 0);
          document.getElementById(cat).innerText = 0;
        });

        saveSummary(); // Create new row for today
      }
    }

    function scheduleMidnightSave() {
      const now = new Date();
      const millisTillMidnight = new Date(
        now.getFullYear(),
        now.getMonth(),
        now.getDate() + 1,
        0, 0, 0, 0
      ) - now;

      setTimeout(() => {
        checkNewDay();
        scheduleMidnightSave(); // reschedule for next midnight
      }, millisTillMidnight);
    }

    function exportToExcel() {
      let summary = JSON.parse(localStorage.getItem("summary") || "[]");
      let data = [["Date", ...categories.map(c => labels[c])]];
      summary.forEach(row => {
        let r = [row.date];
        categories.forEach(c => r.push(row[c] || 0));
        data.push(r);
      });

      let ws = XLSX.utils.aoa_to_sheet(data);
      let wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Call Report");
      XLSX.writeFile(wb, "Call_Report.xlsx");
    }
    function updateDialog() {
  let output = "";
  output += `fresh calls: ${localStorage.getItem("fresh") || 0}\n`;
  output += `positive: ${localStorage.getItem("positive") || 0}\n`;
  output += `neutral: ${localStorage.getItem("neutral") || 0}\n`;
  output += `not intrested: ${localStorage.getItem("not") || 0}\n`;
  output += `follow up: ${localStorage.getItem("followup") || 0}\n`;
  output += `follow up Positive: ${localStorage.getItem("followupPositive") || 0}\n`;
  output += `follow up Not intrested: ${localStorage.getItem("followupNot") || 0}`;
  
  document.getElementById("dialogContent").innerText = output;
}

function copyDialog() {
  const text = document.getElementById("dialogContent").innerText;
  navigator.clipboard.writeText(text).then(() => {
    alert("Copied to clipboard âœ…");
  });
}

// Call updateDialog whenever data changes
function increment(category) {
  let count = parseInt(localStorage.getItem(category) || 0);
  count++;
  localStorage.setItem(category, count);
  document.getElementById(category).innerText = count;
  saveSummary();
  updateDialog();
}

function decrement(category) {
  let count = parseInt(localStorage.getItem(category) || 0);
  if (count > 0) count--;
  localStorage.setItem(category, count);
  document.getElementById(category).innerText = count;
  saveSummary();
  updateDialog();
}

function resetAll() {
  if (confirm("Are you sure you want to reset all counts?")) {
    categories.forEach(cat => {
      localStorage.setItem(cat, 0);
      document.getElementById(cat).innerText = 0;
    });
    saveSummary();
    updateDialog();
  }
}

// Update dialog on page load
window.onload = () => {
  checkNewDay();
  categories.forEach(cat => {
    let saved = localStorage.getItem(cat) || 0;
    document.getElementById(cat).innerText = saved;
  });
  loadSummary();
  scheduleMidnightSave();
  updateDialog();
};
  </script>
</body>
</html>
