<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Call Tracker</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: gradient(to right, #b7cdf9, #006c86);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 1000px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;
      transition: 0.2s;
    }
    .card:hover { transform: scale(1.05); }
    h2 { margin-bottom: 15px; font-size: 20px; }
    .count {
      font-size: 28px;
      margin: 15px 0;
      color: #333;
      font-weight: bold;
    }
    button {
      margin: 5px;
      background: #4f46e5;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #4338ca; }
    .minus { background: #dc2626; }
    .minus:hover { background: #b91c1c; }
    .reset {
      background: #f59e0b;
      margin-top: 20px;
      font-size: 18px;
      padding: 12px 20px;
    }
    .reset:hover { background: #d97706; }
    .export {
      background: #16a34a;
      margin-top: 10px;
      font-size: 18px;
      padding: 12px 20px;
    }
    .export:hover { background: #15803d; }
    /* Category colors */
    .fresh { border-top: 4px solid #2563eb; }
    .positive { border-top: 4px solid #16a34a; }
    .neutral { border-top: 4px solid #facc15; }
    .not-interested { border-top: 4px solid #dc2626; }
    .followup { border-top: 4px solid #0891b2; }
    .followup-positive { border-top: 4px solid #22c55e; }
    .followup-not { border-top: 4px solid #b91c1c; }
  </style>
</head>
<body>
  <h1>ðŸ“ž Call Tracker</h1>
  <button class="reset" onclick="resetAll()">ðŸ”„ Reset All</button>
  <button class="export" onclick="exportToExcel()">ðŸ“¤ Export to Excel</button>

  <div class="container">
    <div class="card fresh">
      <h2>Fresh Calls</h2>
      <div class="count" id="fresh">0</div>
      <button onclick="increment('fresh')">+ Add</button>
      <button class="minus" onclick="decrement('fresh')">- Minus</button>
    </div>

    <div class="card positive">
      <h2>Positives</h2>
      <div class="count" id="positive">0</div>
      <button onclick="increment('positive')">+ Add</button>
      <button class="minus" onclick="decrement('positive')">- Minus</button>
    </div>

    <div class="card neutral">
      <h2>Neutrals</h2>
      <div class="count" id="neutral">0</div>
      <button onclick="increment('neutral')">+ Add</button>
      <button class="minus" onclick="decrement('neutral')">- Minus</button>
    </div>

    <div class="card not-interested">
      <h2>Not Interested</h2>
      <div class="count" id="not">0</div>
      <button onclick="increment('not')">+ Add</button>
      <button class="minus" onclick="decrement('not')">- Minus</button>
    </div>

    <div class="card followup">
      <h2>Follow-ups</h2>
      <div class="count" id="followup">0</div>
      <button onclick="increment('followup')">+ Add</button>
      <button class="minus" onclick="decrement('followup')">- Minus</button>
    </div>

    <div class="card followup-positive">
      <h2>Follow-up Positives</h2>
      <div class="count" id="followupPositive">0</div>
      <button onclick="increment('followupPositive')">+ Add</button>
      <button class="minus" onclick="decrement('followupPositive')">- Minus</button>
    </div>

    <div class="card followup-not">
      <h2>Follow-up Not Interested</h2>
      <div class="count" id="followupNot">0</div>
      <button onclick="increment('followupNot')">+ Add</button>
      <button class="minus" onclick="decrement('followupNot')">- Minus</button>
    </div>
  </div>

  <script>
    const categories = ["fresh","positive","neutral","not","followup","followupPositive","followupNot"];
    const labels = {
      fresh: "Fresh Calls",
      positive: "Positives",
      neutral: "Neutrals",
      not: "Not Interested",
      followup: "Follow-ups",
      followupPositive: "Follow-up Positives",
      followupNot: "Follow-up Not Interested"
    };

    // Load saved data
    window.onload = () => {
      categories.forEach(cat => {
        let saved = localStorage.getItem(cat) || 0;
        document.getElementById(cat).innerText = saved;
      });
    };

    function increment(category) {
      let count = parseInt(localStorage.getItem(category) || 0);
      count++;
      localStorage.setItem(category, count);
      document.getElementById(category).innerText = count;
    }

    function decrement(category) {
      let count = parseInt(localStorage.getItem(category) || 0);
      if (count > 0) count--;
      localStorage.setItem(category, count);
      document.getElementById(category).innerText = count;
    }

    function resetAll() {
      if (confirm("Are you sure you want to reset all counts?")) {
        categories.forEach(cat => {
          localStorage.setItem(cat, 0);
          document.getElementById(cat).innerText = 0;
        });
      }
    }

    function exportToExcel() {
      const today = new Date().toLocaleDateString();
      let data = [["Date", ...categories.map(c => labels[c])]]; // Header row
      let row = [today];

      categories.forEach(cat => {
        let val = localStorage.getItem(cat) || 0;
        row.push(val);
      });

      data.push(row);

      let ws = XLSX.utils.aoa_to_sheet(data);
      let wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Call Report");

      XLSX.writeFile(wb, "Call_Report.xlsx");
    }
  </script>
</body>
</html>
